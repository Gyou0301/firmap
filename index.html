<!DOCTYPE html>
<html lang="ja">

<head>
<meta charset="UTF-8">
<title>Sample_GoogleMap</title>
<link rel ="stylesheet" href ="style.css">
<script
src="https://code.jquery.com/jquery-3.3.1.min.js"
integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
crossorigin="anonymous"></script>
</head>

<body>
<div id="map"></div>
<div id="open"><div id="floatWindow"><a class=close>×　</a></div></div>


<script src="http://maps.google.com/maps/api/js?key=AIzaSyDCiHhzh19SuHZXpHb_tmGQM3TTa1-r7tw&language=ja"></script>


<script type="text/javascript" src="Address.js"></script>
<script>
  var MyLatLng = new google.maps.LatLng(35.168108, 136.885649);
  var Options = {
   zoom: 12,      //地図の縮尺値
   center: MyLatLng,    //地図の中心座標
   mapTypeId: 'roadmap',   //地図の種類
   disableDefaultUI: true
  };
  var map = new google.maps.Map(document.getElementById('map'), Options);

  /*const fs = require('fs');                                             //旭の努力１　Node.js
  let useraddress = JSON.parse(fs.readFileSync("Address.json",'utf8'));
  console.log(useraddress);
  
  useraddress.forEach(function(Address){
    let X = Address[0];
    let Y = Address[1];
    let a = icongene(X,Y);
  });
  
  //console.log(X); */


 const url = "http://localhost/Ubuntu/var/www/html";         //旭の努力２    getJSON urlから
  
  $.getJSON(url, useraddress);
 // JSONデータを受信した後に実行する処理
 useraddress.forEach(function(Address){
    let X = Address[0];
    let Y = Address[1];
    let a = icongene(X,Y);
  });

/*var useraddress = [
    [35.137612,136.889264],
    [35.176285,136.880314],
    [35.154861,136.910500],
    
];

var json = JSON.stringify(useraddress);
//console.log(json);*/
/*var useraddress = JSON.parse(json);

useraddress.forEach(function(User){
    let X = User[0];
    let Y = User[1];
    let a = icongene(X,Y);
  });
  */
    
    // クリックイベントの登録
    google.maps.event.addListener(markerObj, 'click', function() {
          clickMarker('BRISKです');   // クリックした時の動作内容
        });
    
    // クリックした時の動作内容
    function clickMarker(text) {
      $("#open").fadeIn("fast");
      return false;
    }

    $("#open a.close").click(function(){
        $("#open").fadeOut("fast");
        return false;
    })

    function icongene(x,y){
       // MARKERイメージを作成
   markerImg = new google.maps.MarkerImage(
            "firmap_picture/usericon.png",  // アイコン画像のパス
            new google.maps.Size(54, 50),     // アイコン画像の表示させたい範囲（サイズ）
            new google.maps.Point(0, 0),      // アイコン画像の表示させたい範囲の基準点（左上）
            new google.maps.Point(27, 50),    // アイコン画像内のアンカー点の位置
            new google.maps.Size(54, 50)      // アイコン画像の実際の表示サイズ
        );
        
    // MARKERオブジェクトを作成
    markerObj = new google.maps.Marker({
            position: new google.maps.LatLng(x,y), // アイコンのアンカー点の緯度・経度
            map: map,                                           // 上で作成したMAPオブジェクトを指定
            icon: markerImg                                        // 上で作成したMARKERイメージを指定
        });
    }
</script>

</body>
</html>


